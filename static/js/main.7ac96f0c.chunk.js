(this.webpackJsonppixelator=this.webpackJsonppixelator||[]).push([[0],{19:function(e,t,a){e.exports=a(38)},24:function(e,t,a){},25:function(e,t,a){},31:function(e,t,a){},32:function(e,t,a){},33:function(e,t,a){},35:function(e,t,a){},36:function(e,t,a){},37:function(e,t,a){},38:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(16),i=a.n(c),l=(a(24),a(2)),o=a(7);a(25);function u(){return r.a.createElement("div",{className:"top-bar"},r.a.createElement("p",{className:"title"},"Pixelator"),r.a.createElement(o.b,{to:"/"},r.a.createElement("p",{className:"link"},"Home")),r.a.createElement(o.b,{to:"/about"},r.a.createElement("p",{className:"link"},"About")))}var s=a(10),m=a(5),f=a(8),d=(a(31),r.a.forwardRef((function(e,t){return r.a.createElement("button",Object.assign({ref:t},e,{className:"button"}))}))),g=r.a.forwardRef((function(e,t){return r.a.createElement("button",Object.assign({ref:t},e,{className:"button rounded"}))}));a(32);function b(e){var t=e.square,a=e.other;return r.a.createElement("div",{className:"square-container"},r.a.createElement("div",{className:"square-other"},a),r.a.createElement("div",{className:"square-block"},t))}a(33);function p(e){var t=e.name,a=e.children,n=e.end;return r.a.createElement("div",{className:"flex-container"},r.a.createElement("p",{className:"flex-fixed setting-name"},t),r.a.createElement("div",{className:"flex-expand"},a),r.a.createElement("div",{className:"flex-fixed setting-end"},n))}var h=function(e){Object(n.useEffect)((function(){document.title=e}),[e])},v=function(e){var t=Object(n.useContext)(B);return Object(n.useCallback)((function(a){t({type:e,payload:a})}),[t,e])},E=function(e){return e(Object(n.useContext)(_))};function j(e){var t=e.onSubmit,a=E((function(e){return e.settings})),c=a.data,i=a.width,o=a.imageWidth,u=a.imageHeight,h=a.initialColor,v=a.initialEdge,j=a.iterationCount,O=a.sampleDistance,x=Object(n.useState)(o),w=Object(l.a)(x,2),y=w[0],C=w[1],k=Object(n.useState)(u),N=Object(l.a)(k,2),I=N[0],S=N[1],D=Object(n.useState)(i),A=Object(l.a)(D,2),F=A[0],M=A[1],R=Object(n.useState)({nextIndex:h.length,color:h.map((function(e,t){return Object(f.a)({},t,e)})).reduce((function(e,t){return Object.assign({},e,t)}),{}),id:new Array(h.length).fill(0).map((function(e,t){return t}))}),P=Object(l.a)(R,2),W=P[0],q=P[1];console.dir(W);var H=Object(n.useState)({nextIndex:v.length,edge:v.map((function(e,t){return Object(f.a)({},t,e)})).reduce((function(e,t){return Object.assign({},e,t)}),{}),id:new Array(v.length).fill(0).map((function(e,t){return t}))}),_=Object(l.a)(H,2),B=_[0],L=_[1],T=Object(n.useState)(c),J=Object(l.a)(T,2),z=J[0],U=J[1],$=Object(n.useState)(j),G=Object(l.a)($,2),K=G[0],Q=G[1],V=Object(n.useState)(O),X=Object(l.a)(V,2),Y=X[0],Z=X[1],ee=Object(n.useRef)(),te=Object(n.useRef)(),ae=Object(n.useCallback)((function(e){e.preventDefault(),te.current.click()}),[te]),ne=Object(n.useCallback)((function(e){var t=new FileReader;t.onload=function(){return a.src=t.result},t.readAsDataURL(e.target.files[0]);var a=new Image;a.onload=function(){if(C(a.width),S(a.height),ee.current){var e=ee.current.getContext("2d");e.drawImage(a,0,0,a.width,a.height),U(e.getImageData(0,0,a.width,a.height).data),Z(Math.ceil(Math.max(a.width,a.height)/50))}}}),[ee,U,C,S]),re=Object(n.useCallback)((function(e){M(e.target.value)}),[M]),ce=Object(n.useCallback)((function(e){e.preventDefault();var t=e.target.name,a=e.target.value;q((function(e){var n=Object.assign({},e.color);return n[t]=a,Object(m.a)({},e,{color:n})}))}),[q]),ie=Object(n.useCallback)((function(e){e.preventDefault(),q((function(e){return Object(m.a)({},e,{nextIndex:e.nextIndex+1,id:[].concat(Object(s.a)(e.id),[e.nextIndex]),color:Object(m.a)({},e.color,Object(f.a)({},e.nextIndex,"#000000"))})}))}),[q]),le=Object(n.useCallback)((function(e){e.preventDefault(),q((function(e){var t=e.id,a=t.pop(),n=e.color;return delete n[a],Object(m.a)({},e,{color:n,id:t})}))}),[q]),oe=Object(n.useCallback)((function(e){e.preventDefault();var t=e.target.name,a=e.target.value;L((function(e){var n=Object.assign({},e.edge);return n[t]=a,Object(m.a)({},e,{edge:n})}))}),[L]),ue=Object(n.useCallback)((function(e){e.preventDefault(),L((function(e){return Object(m.a)({},e,{nextIndex:e.nextIndex+1,id:[].concat(Object(s.a)(e.id),[e.nextIndex]),edge:Object(m.a)({},e.edge,Object(f.a)({},e.nextIndex,"#000000"))})}))}),[L]),se=Object(n.useCallback)((function(e){e.preventDefault(),L((function(e){var t=e.id,a=t.pop(),n=e.edge;return delete n[a],Object(m.a)({},e,{edge:n,id:t})}))}),[L]),me=Object(n.useCallback)((function(e){e.preventDefault(),Q(e.target.value)}),[]),fe=Object(n.useCallback)((function(e){e.preventDefault(),Z(e.target.value)}),[]),de=Object(n.useCallback)((function(e){e.preventDefault(),t&&t(z,y,I,Number(F),Object.values(W.color),Object.values(B.edge),Number(K),Number(Y))}),[t,F,z,y,I,W,B,K,Y]);return Object(n.useEffect)((function(){z&&ee.current.getContext("2d").putImageData(new ImageData(z,y,I),0,0)}),[]),r.a.createElement(b,{other:r.a.createElement("form",{className:"form normal-page-padding",onSubmit:de},r.a.createElement("div",{className:"dummy-height"}),r.a.createElement("h1",null,"Instructions"),r.a.createElement("div",{className:"normal-padding"},r.a.createElement("p",null,"Select an image with few colors and sufficiently wide margin."),r.a.createElement("p",null,"Choose the main colors in the image."),r.a.createElement("p",null,"Choose the color of the edge if necessary."),r.a.createElement("p",null,"Increase sample distance if the calculation is too slow.")),r.a.createElement(p,{name:"Image"},r.a.createElement("input",{className:"hidden",ref:te,type:"file",onChange:ne}),r.a.createElement(d,{onClick:ae},"Choose an image")),r.a.createElement(p,{name:"Tile width"},r.a.createElement("input",{type:"number",onChange:re,value:F})),r.a.createElement(p,{name:"Iteration Count"},r.a.createElement("input",{type:"number",onChange:me,value:K})),r.a.createElement(p,{name:"Sample Distance"},r.a.createElement("input",{type:"number",onChange:fe,value:Y})),r.a.createElement(p,{name:"Color",end:r.a.createElement(r.a.Fragment,null,r.a.createElement(g,{onClick:ie},"+"),r.a.createElement(g,{onClick:le},"-"))},W.id.map((function(e){return r.a.createElement("input",{key:"color_".concat(e),type:"color",value:W.color[e],name:e,onChange:ce})}))),r.a.createElement(p,{name:"Edge",end:r.a.createElement(r.a.Fragment,null,r.a.createElement(g,{onClick:ue},"+"),r.a.createElement(g,{onClick:se},"-"))},B.id.map((function(e){return r.a.createElement("input",{key:"edge_".concat(e),type:"color",value:B.edge[e],name:e,onChange:oe})}))),r.a.createElement("div",{className:"normal-padding"},r.a.createElement(d,{disabled:!z,type:"submit"},"Submit"))),square:r.a.createElement("div",{className:"overflow-scroll full"},r.a.createElement("div",{className:"dummy-height"}),r.a.createElement("canvas",{ref:ee,width:y.toString(),height:I.toString()}))})}var O=a(4),x=a.n(O);function w(e,t){var a=new Array(256).fill(0),n=new Array(256).fill(0),r=new Array(256).fill(0),c=new Array(256).fill(0),i=!0,l=!1,o=void 0;try{for(var u,s=t[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){for(var m=u.value,f=e.length/4,d=0,g=0;g<e.length;g+=4){C(e.slice(g,g+4),m)<30&&d++}if(d>.03*f)return m}}catch(b){l=!0,o=b}finally{try{i||null==s.return||s.return()}finally{if(l)throw o}}return e.forEach((function(e,t){switch(t%4){case 0:a[e]++;break;case 1:n[e]++;break;case 2:r[e]++;break;case 3:c[e]++}})),[a,n,r,c].map((function(t){for(var a=0,n=0;n<256;n++)if((a+=t[n])>=e.length/8)return n;return 255}))}function y(e,t,a,n,r,c){var i,l,o,u,s,m,f,d;return x.a.async((function(g){for(;;)switch(g.prev=g.next){case 0:for(i=Math.floor(t/n),l=Math.floor(a/i),o=new Array(n*l),u=0;u<l;u++)for(s=0;s<n;s++)for(m=u*i;m<(u+1)*i;m+=r)for(f=s*i;f<(s+1)*i;f+=r)o[u*n+s]||(o[u*n+s]=[]),d=m*t+f,o[u*n+s].push(e.slice(4*d,4*d+4));return g.abrupt("return",o.map((function(e){return w(e.reduce((function(e,t){return Array.from(e).concat(Array.from(t))})),c)})).reduce((function(e,t){return e.concat(t)})));case 5:case"end":return g.stop()}}))}function C(e,t){for(var a=0,n=0;n<3;n++)a+=(e[n]-t[n])*(e[n]-t[n]);return a}function k(e){var t=e[3]/255;return t?[e[0]*t,e[1]*t,e[2]*t,255]:new Array(4).fill(255)}function N(e,t,a){var n,r;return x.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:for(n=[],r=0;r<e.length;r+=4)n.push(k(e.slice(r,r+4)));return c.abrupt("return",new Promise((function(e){return e(D(n,C,t,a))})));case 3:case"end":return c.stop()}}))}function I(e,t,a){var n,r,c,i;return x.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,x.a.awrap(N(e,t,a));case 2:for(i in n=l.sent,r=n.centroid,c=n.types)e.splice.apply(e,[4*i,4].concat(Object(s.a)(r[c[i]])));return l.next=8,x.a.awrap(e);case 8:return l.abrupt("return",l.sent);case 9:case"end":return l.stop()}}))}var S=function(e,t){for(var a=0;a<t;a++)e(a)};function D(e,t,a,n){var r=a,c=e.map((function(e,t){return 0})),i=a.length;return S((function(){for(var n=new Array(i).fill(new Array(a[0].length).fill(0)),l=new Array(i).fill(0),o=function(a){var i=function(e,t,a){var n=-1,r=-1;return t.forEach((function(t,c){var i=a(e,t);(i<r||-1===r)&&(n=c,r=i)})),n}(e[a],r,t);c[a]=i,n[i]=n[i].map((function(t,n){return t+e[a][n]})),l[i]++},u=0;u<e.length;u++)o(u);r=n.map((function(e,t){return 0!==l[t]?e.map((function(e){return e/l[t]})):r[t]}))}),n),{centroid:r,types:c}}var A=a(6);function F(e){var t=Object(A.g)(),a=v("save_settings"),c=Object(n.useCallback)((function(e,n,r,c,i,l,o,u){a({data:e,imageWidth:n,imageHeight:r,width:c,initialColor:i,initialEdge:l,iterationCount:o,sampleDistance:u});for(var s=0;s<e.length;s+=4){var m=k(e.slice(s,s+4));e[s]=m[0],e[s+1]=m[1],e[s+2]=m[2],e[s+3]=m[3]}t.push({pathname:"/result"})}),[t,a]);return h("Pixelator"),r.a.createElement(j,{onSubmit:c})}a(35);function M(e){var t=e.data,a=e.width,n=e.height;if(!t)return r.a.createElement("div",null);for(var c=[],i=0;i<n;i++){c.push([]);for(var l=0;l<a;l++){var o=4*(i*a+l),u=t.slice(o,o+4);c[i].push(r.a.createElement("div",{key:"".concat(i," ").concat(l),style:{backgroundColor:"rgb(".concat(u[0],", ").concat(u[1],", ").concat(u[2],", ").concat(u[3],")"),width:"calc(100% / ".concat(a,")"),paddingBottom:"calc(100% / ".concat(a,")"),flex:"0 0 auto"}}))}}return r.a.createElement("div",null,c.map((function(e,t){return r.a.createElement("div",{className:"result-line",key:t.toString()},e)})))}a(36);function R(e){var t=e.mapping;return r.a.createElement("div",{className:"result-guide-container normal-page-padding"},Object.keys(t).map((function(e){return r.a.createElement("div",{key:e.toString(),className:"result-guide-item"},r.a.createElement("div",{style:{backgroundColor:e,width:"50px",height:"50px",minWidth:"50px",minHeight:"50px",border:"1px solid black",marginRight:"8px"}}),r.a.createElement("p",null,t[e]))})))}function P(e){var t=Object(n.useCallback)((function(e){return e.map((function(e){return[parseInt(e.substr(1,2),16),parseInt(e.substr(3,2),16),parseInt(e.substr(5,2),16),255]}))}),[]),a=E((function(e){return e.settings})),c=a.data,i=a.imageWidth,o=a.imageHeight,u=a.width,s=a.initialColor,m=a.initialEdge,f=a.iterationCount,d=a.sampleDistance,g=Object(n.useMemo)((function(){return t(s)}),[t,s]),p=Object(n.useMemo)((function(){return t(m)}),[t,m]),v=Object(n.useState)(),j=Object(l.a)(v,2),O=j[0],w=j[1];h("Pixelator | Result"),Object(n.useEffect)((function(){c&&function(){var e,t;x.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,x.a.awrap(y(c,i,o,u,d,p));case 2:return e=a.sent,a.next=5,x.a.awrap(I(e,g,f));case 5:t=a.sent,w(t);case 7:case"end":return a.stop()}}))}()}),[c,i,o,u,g,p,f,d]);var C={};if(O)for(var k=0;k<O.length;k+=4){var N="rgb(".concat(O[k],", ").concat(O[k+1],", ").concat(O[k+2],")");C[N]?C[N]++:C[N]=1}return c?r.a.createElement(b,{square:r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"dummy-height"}),r.a.createElement(M,{data:O,width:u,height:Math.floor(o/Math.floor(i/u))})),other:r.a.createElement("div",{className:"normal-page-padding"},r.a.createElement("div",{className:"dummy-height"}),r.a.createElement(R,{mapping:C}))}):r.a.createElement(A.a,{to:"/"})}function W(){return r.a.createElement("div",{className:"normal-page-padding"},r.a.createElement("div",{className:"dummy-height"}),r.a.createElement("h1",null,"About"),r.a.createElement("div",{className:"normal-padding"},r.a.createElement("p",null,'Pixelator is an "image discretizer" which generates Lennon Arts, written by CaffeinatedProgrammer.'),r.a.createElement("p",null,"The source code is release under the MIT License.")))}a(37);var q=function(e,t){switch(t.type){case"save_settings":return Object.assign({},e,{settings:t.payload});default:return e}},H={settings:{width:20,imageWidth:0,imageHeight:0,initialColor:["#000000","#FFFFFF","#FFFF00","#FF0000"],initialEdge:["#000000"],iterationCount:50,sampleDistance:5}},_=r.a.createContext(),B=r.a.createContext();var L=function(){var e=Object(n.useReducer)(q,H),t=Object(l.a)(e,2),a=t[0],c=t[1];return r.a.createElement(_.Provider,{value:a},r.a.createElement(B.Provider,{value:c},r.a.createElement(o.a,{basename:"/pixelator"},r.a.createElement("div",{className:"container"},r.a.createElement(u,null),r.a.createElement(A.d,null,r.a.createElement(A.b,{exact:!0,path:"/result"},r.a.createElement(P,null)),r.a.createElement(A.b,{exact:!0,path:"/about"},r.a.createElement(W,null)),r.a.createElement(A.b,{exact:!0,path:"/"},r.a.createElement(F,null)))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(L,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[19,1,2]]]);
//# sourceMappingURL=main.7ac96f0c.chunk.js.map