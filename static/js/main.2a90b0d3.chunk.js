(this.webpackJsonppixelator=this.webpackJsonppixelator||[]).push([[0],{19:function(e,t,n){e.exports=n(37)},24:function(e,t,n){},25:function(e,t,n){},26:function(e,t,n){},27:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(16),i=n.n(c),l=(n(24),n(2)),o=n(9),u=n(5),s=n(7),f=(n(25),r.a.forwardRef((function(e,t){return r.a.createElement("button",Object.assign({ref:t},e,{className:"button"}))}))),m=r.a.forwardRef((function(e,t){return r.a.createElement("button",Object.assign({ref:t},e,{className:"button rounded"}))}));n(26);function d(e){var t=e.square,n=e.other;return r.a.createElement("div",{className:"square-container"},r.a.createElement("div",{className:"square-other"},n),r.a.createElement("div",{className:"square-block"},t))}n(27);function b(e){var t=e.name,n=e.children,a=e.end;return r.a.createElement("div",{className:"flex-container"},r.a.createElement("p",{className:"flex-fixed setting-name"},t),r.a.createElement("div",{className:"flex-expand"},n),r.a.createElement("div",{className:"flex-fixed setting-end"},a))}var p=function(e){Object(a.useEffect)((function(){document.title=e}),[e])},g=function(e){var t=Object(a.useContext)(W);return Object(a.useCallback)((function(n){t({type:e,payload:n})}),[t,e])},v=function(e){return e(Object(a.useContext)(P))};function h(e){var t=e.onSubmit,n=v((function(e){return e.settings})),c=n.width,i=n.initialColor,p=n.initialEdge,g=n.iterationCount,h=n.sampleDistance,E=Object(a.useState)(0),j=Object(l.a)(E,2),O=j[0],x=j[1],w=Object(a.useState)(0),y=Object(l.a)(w,2),C=y[0],k=y[1],I=Object(a.useState)(c),N=Object(l.a)(I,2),S=N[0],D=N[1],F=Object(a.useState)({nextIndex:i.length,color:i.map((function(e,t){return Object(s.a)({},t,e)})).reduce((function(e,t){return Object.assign({},e,t)}),{}),id:new Array(i.length).fill(0).map((function(e,t){return t}))}),A=Object(l.a)(F,2),R=A[0],q=A[1],M=Object(a.useState)({nextIndex:p.length,edge:p.map((function(e,t){return Object(s.a)({},t,e)})).reduce((function(e,t){return Object.assign({},e,t)}),{}),id:new Array(p.length).fill(0).map((function(e,t){return t}))}),B=Object(l.a)(M,2),P=B[0],W=B[1],_=Object(a.useState)(),H=Object(l.a)(_,2),J=H[0],G=H[1],L=Object(a.useState)(g),T=Object(l.a)(L,2),U=T[0],$=T[1],z=Object(a.useState)(h),K=Object(l.a)(z,2),Q=K[0],V=K[1],X=Object(a.useRef)(),Y=Object(a.useRef)(),Z=Object(a.useCallback)((function(e){e.preventDefault(),Y.current.click()}),[Y]),ee=Object(a.useCallback)((function(e){var t=new FileReader;t.onload=function(){return n.src=t.result},t.readAsDataURL(e.target.files[0]);var n=new Image;n.onload=function(){if(x(n.width),k(n.height),X.current){var e=X.current.getContext("2d");e.drawImage(n,0,0,n.width,n.height),G(e.getImageData(0,0,n.width,n.height).data)}}}),[X,G,x,k]),te=Object(a.useCallback)((function(e){D(e.target.value)}),[D]),ne=Object(a.useCallback)((function(e){e.preventDefault();var t=e.target.name,n=e.target.value;q((function(e){var a=Object.assign({},e.color);return a[t]=n,Object(u.a)({},e,{color:a})}))}),[q]),ae=Object(a.useCallback)((function(e){e.preventDefault(),q((function(e){return Object(u.a)({},e,{nextIndex:e.nextIndex+1,id:[].concat(Object(o.a)(e.id),[e.nextIndex]),color:Object(u.a)({},e.color,Object(s.a)({},e.nextIndex,"#000000"))})}))}),[q]),re=Object(a.useCallback)((function(e){e.preventDefault(),q((function(e){var t=e.id,n=(t.pop(),e.color);return delete n.lastId,Object(u.a)({},e,{color:n,id:t})}))}),[q]),ce=Object(a.useCallback)((function(e){e.preventDefault();var t=e.target.name,n=e.target.value;W((function(e){var a=Object.assign({},e.edge);return a[t]=n,Object(u.a)({},e,{edge:a})}))}),[W]),ie=Object(a.useCallback)((function(e){e.preventDefault(),W((function(e){return Object(u.a)({},e,{nextIndex:e.nextIndex+1,id:[].concat(Object(o.a)(e.id),[e.nextIndex]),edge:Object(u.a)({},e.edge,Object(s.a)({},e.nextIndex,"#000000"))})}))}),[W]),le=Object(a.useCallback)((function(e){e.preventDefault(),W((function(e){var t=e.id,n=(t.pop(),e.edge);return delete n.lastId,Object(u.a)({},e,{edge:n,id:t})}))}),[W]),oe=Object(a.useCallback)((function(e){e.preventDefault(),$(e.target.value)}),[]),ue=Object(a.useCallback)((function(e){e.preventDefault(),V(e.target.value)}),[]),se=Object(a.useCallback)((function(e){e.preventDefault(),t&&t(J,O,C,Number(S),Object.values(R.color),Object.values(P.edge),Number(U),Number(Q))}),[t,S,J,O,C,R,P,U,Q]);return r.a.createElement(d,{other:r.a.createElement("form",{className:"form",onSubmit:se},r.a.createElement("div",{className:"normal-padding"},r.a.createElement("h3",null,"Instructions:"),r.a.createElement("p",null,"Select an image with few colors and sufficiently wide margin."),r.a.createElement("p",null,"Choose the main colors in the image."),r.a.createElement("p",null,"Choose the color of the edge if necessary."),r.a.createElement("p",null,"Increase sample distance if the calculation is too slow.")),r.a.createElement(b,{name:"Image"},r.a.createElement("input",{className:"hidden",ref:Y,type:"file",onChange:ee}),r.a.createElement(f,{onClick:Z},"Choose an image")),r.a.createElement(b,{name:"Tile width"},r.a.createElement("input",{type:"number",onChange:te,value:S})),r.a.createElement(b,{name:"Iteration Count"},r.a.createElement("input",{type:"number",onChange:oe,value:U})),r.a.createElement(b,{name:"Sample Distance"},r.a.createElement("input",{type:"number",onChange:ue,value:Q})),r.a.createElement(b,{name:"Color",end:r.a.createElement(r.a.Fragment,null,r.a.createElement(m,{onClick:ae},"+"),r.a.createElement(m,{onClick:re},"-"))},R.id.map((function(e){return r.a.createElement("input",{key:"color_".concat(e),type:"color",value:R.color[e],name:e,onChange:ne})}))),r.a.createElement(b,{name:"Edge",end:r.a.createElement(r.a.Fragment,null,r.a.createElement(m,{onClick:ie},"+"),r.a.createElement(m,{onClick:le},"-"))},P.id.map((function(e){return r.a.createElement("input",{key:"edge_".concat(e),type:"color",value:P.edge[e],name:e,onChange:ce})}))),r.a.createElement("div",{className:"normal-padding"},r.a.createElement(f,{disabled:!J,type:"submit"},"Submit"))),square:r.a.createElement("div",{className:"overflow-scroll full"},r.a.createElement("canvas",{ref:X,width:O.toString(),height:C.toString()}))})}var E=n(4),j=n.n(E);function O(e,t){var n=new Array(256).fill(0),a=new Array(256).fill(0),r=new Array(256).fill(0),c=new Array(256).fill(0),i=!0,l=!1,o=void 0;try{for(var u,s=t[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){for(var f=u.value,m=e.length/4,d=0,b=0;b<e.length;b+=4){w(e.slice(b,b+4),f)<30&&d++}if(d>.03*m)return f}}catch(p){l=!0,o=p}finally{try{i||null==s.return||s.return()}finally{if(l)throw o}}return e.forEach((function(e,t){switch(t%4){case 0:n[e]++;break;case 1:a[e]++;break;case 2:r[e]++;break;case 3:c[e]++}})),[n,a,r,c].map((function(t){for(var n=0,a=0;a<256;a++)if((n+=t[a])>=e.length/8)return a;return 255}))}function x(e,t,n,a,r,c){var i,l,o,u,s,f,m,d;return j.a.async((function(b){for(;;)switch(b.prev=b.next){case 0:for(i=Math.floor(t/a),l=Math.floor(n/i),o=new Array(a*l),u=0;u<l;u++)for(s=0;s<a;s++)for(f=u*i;f<(u+1)*i;f+=r)for(m=s*i;m<(s+1)*i;m+=r)o[u*a+s]||(o[u*a+s]=[]),d=f*t+m,o[u*a+s].push(e.slice(4*d,4*d+4));return b.abrupt("return",o.map((function(e){return O(e.reduce((function(e,t){return Array.from(e).concat(Array.from(t))})),c)})).reduce((function(e,t){return e.concat(t)})));case 5:case"end":return b.stop()}}))}function w(e,t){for(var n=0,a=0;a<3;a++)n+=(e[a]-t[a])*(e[a]-t[a]);return n}function y(e){var t=e[3]/255;return t?[e[0]*t,e[1]*t,e[2]*t,255]:new Array(4).fill(255)}function C(e,t,n){var a,r;return j.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:for(a=[],r=0;r<e.length;r+=4)a.push(y(e.slice(r,r+4)));return c.abrupt("return",new Promise((function(e){return e(N(a,w,t,n))})));case 3:case"end":return c.stop()}}))}function k(e,t,n){var a,r,c,i;return j.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,j.a.awrap(C(e,t,n));case 2:for(i in a=l.sent,r=a.centroid,c=a.types)e.splice.apply(e,[4*i,4].concat(Object(o.a)(r[c[i]])));return l.next=8,j.a.awrap(e);case 8:return l.abrupt("return",l.sent);case 9:case"end":return l.stop()}}))}var I=function(e,t){for(var n=0;n<t;n++)e(n)};function N(e,t,n,a){var r=n,c=e.map((function(e,t){return 0})),i=n.length;return I((function(){for(var a=new Array(i).fill(new Array(n[0].length).fill(0)),l=new Array(i).fill(0),o=function(n){var i=function(e,t,n){var a=-1,r=-1;return t.forEach((function(t,c){var i=n(e,t);(i<r||-1===r)&&(a=c,r=i)})),a}(e[n],r,t);c[n]=i,a[i]=a[i].map((function(t,a){return t+e[n][a]})),l[i]++},u=0;u<e.length;u++)o(u);r=a.map((function(e,t){return 0!==l[t]?e.map((function(e){return e/l[t]})):r[t]}))}),a),{centroid:r,types:c}}var S=n(6);function D(e){var t=Object(S.f)(),n=g("save_settings"),c=Object(a.useCallback)((function(e,a,r,c,i,l,o,u){n({data:e,imageWidth:a,imageHeight:r,width:c,initialColor:i,initialEdge:l,iterationCount:o,sampleDistance:u});for(var s=0;s<e.length;s+=4){var f=y(e.slice(s,s+4));e[s]=f[0],e[s+1]=f[1],e[s+2]=f[2],e[s+3]=f[3]}t.push({pathname:"/result"})}),[t,n]);return p("Pixelator"),r.a.createElement("div",{className:"container"},r.a.createElement(h,{onSubmit:c}))}n(34);function F(e){var t=e.data,n=e.width,a=e.height;if(!t)return r.a.createElement("div",null);for(var c=[],i=0;i<a;i++){c.push([]);for(var l=0;l<n;l++){var o=4*(i*n+l),u=t.slice(o,o+4);c[i].push(r.a.createElement("div",{key:"".concat(i," ").concat(l),style:{backgroundColor:"rgb(".concat(u[0],", ").concat(u[1],", ").concat(u[2],", ").concat(u[3],")"),width:"calc(100% / ".concat(n,")"),paddingBottom:"calc(100% / ".concat(n,")"),flex:"0 0 auto"}}))}}return r.a.createElement("div",{className:"result-container"},c.map((function(e,t){return r.a.createElement("div",{className:"result-line",key:t.toString()},e)})))}n(35);function A(e){var t=e.mapping;return r.a.createElement("div",{className:"result-guide-container"},Object.keys(t).map((function(e){return r.a.createElement("div",{key:e.toString(),className:"result-guide-item"},r.a.createElement("div",{style:{backgroundColor:e,width:"50px",height:"50px",minWidth:"50px",minHeight:"50px",border:"1px solid black",marginRight:"8px"}}),r.a.createElement("p",null,t[e]))})))}function R(e){var t=Object(S.f)(),n=Object(a.useCallback)((function(e){return e.map((function(e){return[parseInt(e.substr(1,2),16),parseInt(e.substr(3,2),16),parseInt(e.substr(5,2),16),255]}))}),[]),c=v((function(e){return e.settings})),i=c.data,o=c.imageWidth,u=c.imageHeight,s=c.width,m=c.initialColor,b=c.initialEdge,g=c.iterationCount,h=c.sampleDistance,E=Object(a.useMemo)((function(){return n(m)}),[n,m]),O=Object(a.useMemo)((function(){return n(b)}),[n,b]),w=Object(a.useState)(),y=Object(l.a)(w,2),C=y[0],I=y[1];p("Pixelator | Result"),Object(a.useEffect)((function(){!function(){var e,t;j.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,j.a.awrap(x(i,o,u,s,h,O));case 2:return e=n.sent,n.next=5,j.a.awrap(k(e,E,g));case 5:t=n.sent,I(t);case 7:case"end":return n.stop()}}))}()}),[i,o,u,s,E,O,g,h]);var N={};if(C)for(var D=0;D<C.length;D+=4){var R="rgb(".concat(C[D],", ").concat(C[D+1],", ").concat(C[D+2],")");N[R]?N[R]++:N[R]=1}return r.a.createElement(r.a.Fragment,null,r.a.createElement(d,{square:r.a.createElement(F,{data:C,width:s,height:Math.floor(u/Math.floor(o/s))}),other:r.a.createElement(r.a.Fragment,null,r.a.createElement(f,{onClick:t.goBack},"Go Back"),r.a.createElement(A,{mapping:N}))}))}n(36);var q=n(10),M=function(e,t){switch(t.type){case"save_settings":return Object.assign({},e,{settings:t.payload});default:return e}},B={settings:{width:20,initialColor:["#000000","#FFFFFF","#FFFF00","#FF0000"],initialEdge:["#000000"],iterationCount:50,sampleDistance:1}},P=r.a.createContext(),W=r.a.createContext();var _=function(){var e=Object(a.useReducer)(M,B),t=Object(l.a)(e,2),n=t[0],c=t[1];return r.a.createElement(P.Provider,{value:n},r.a.createElement(W.Provider,{value:c},r.a.createElement(q.a,{basename:"/pixelator"},r.a.createElement(S.c,null,r.a.createElement(S.a,{exact:!0,path:"/result"},r.a.createElement(R,null)),r.a.createElement(S.a,{exact:!0,path:"/"},r.a.createElement(D,null))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(_,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[19,1,2]]]);
//# sourceMappingURL=main.2a90b0d3.chunk.js.map